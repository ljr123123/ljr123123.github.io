import{_ as q,r,d as H,e as G,o as B,c as P,f as F,g as E,a as c,F as N,h as z,t as M,w as S,v as x,n as J,i as O}from"./index-a91608f4.js";const Q={class:"game-page"},W={class:"game-box"},X={class:"game-row"},Y={class:"score"},Z={class:"grey-block"},ee={__name:"GamePage",setup(oe){let g="",f="",i=!0;const t=[],d=r(0),e={row:0,col:0},y=30,b=60;let _=0,u="",n=[];const C=r();let o=[[1,1],[1,1],[1,1],[1,1]],v=1;const p=r(0),h=r(0);for(let a=0;a<y;a++){let l=[];for(let s=0;s<b;s++)l.push({prop_one:r(!1),prop_two:r(!1),snake_head:r(!1),snake_body:r(!1),food_one:r(!1),food_two:r(!1)});t.push(l)}function L(a,l){if(a.length!=l.length)return!1;for(let s=0;s<a.length;s++)if(a[s]!=l[s])return!1;return!0}function V(a){let l=a.key;l=="ArrowUp"?u="up":l=="ArrowDown"?u="down":l=="ArrowLeft"?u="left":l=="ArrowRight"&&(u="right")}function $(){C.value.focus()}function K(){let a=!1;n.forEach(l=>{L(l,[e.row,e.col])&&(a=!0)}),a||(n.unshift([e.row,e.col]),t[e.row][e.col].snake_body.value=!0)}function m(){t[o[0][0]][o[0][1]].prop_one.value=!1,t[o[1][0]][o[1][1]].prop_two.value=!1,t[o[2][0]][o[2][1]].food_one.value=!1,t[o[3][0]][o[3][1]].food_two.value=!1;let a=[];for(;;){let l=Math.floor(Math.random()*(b-2))+1,s=Math.floor(Math.random()*(y-2))+1;if(!a.includes([s,l]!=-1||[s,l]==[e.row,e.col]||n.includes([s,l]!=-1))){if(a.length==4)break;a.push([s,l])}}o=a,t[o[0][0]][o[0][1]].prop_one.value=!0,t[o[1][0]][o[1][1]].prop_two.value=!0,t[o[2][0]][o[2][1]].food_one.value=!0,t[o[3][0]][o[3][1]].food_two.value=!0}function D(){p.value=0,h.value=0,_=200,n.forEach(a=>{t[a[0]][a[1]].snake_body.value=!1}),d.value=0,i=!0,n.length>200&&(t[e.row][e.col].snake_head.value=!1),n.length=0,e.row=1,e.col=1,t[1][1].snake_head.value=!0,u="down",C.value.focus(),A(),I(),m()}function I(){if(!i){clearInterval(g),clearInterval(f);return}g=setInterval(()=>{h.value&&h.value--,p.value&&p.value--,d.value=d.value+v,_-=2,clearInterval(f),clearInterval(g),A(),I()},1e3)}function A(){return f=setInterval(()=>{n.length>200&&(i=!1),(e.col==0||e.row==0||e.col==b-1||e.row==y-1)&&(i=!1),t[e.row][e.col].snake_head.value=!1,K(),u=="up"?e.row=e.row-1:u=="down"?e.row=e.row+1:u=="left"?e.col=e.col-1:u=="right"&&(e.col=e.col+1),t[e.row][e.col].snake_head.value=!0;for(let a=0;a<4;a++)o[0][0]==e.row&&o[0][1]==e.col?(m(),clearInterval(f),clearInterval(g),p.value=10,_=_*2,f=A(),I(),setTimeout(()=>{clearInterval(f),clearInterval(g),_=(_+50)/2,i&&(A(),I())},1e4)):o[1][0]==e.row&&o[1][1]==e.col?(m(),n.splice(n.length%2==0?n.length/2:(n.length+1)/2).forEach(s=>{t[s[0]][s[1]].snake_body.value=!1})):o[2][0]==e.row&&o[2][1]==e.col?(m(),v&&d.value++,d.value+=20):o[3][0]==e.row&&o[3][1]==e.col&&(h.value=10,v=v*2,m(),setTimeout(()=>v=v/2,1e4))},_),f}return H(()=>{D()}),(a,l)=>{const s=G("Panel"),U=G("TitleBar"),j=G("Child");return B(),P("div",Q,[F(s,{if_show:!E(i),onRefresh:l[0]||(l[0]=k=>D())},null,8,["if_show"]),F(U),c("input",{class:"focus",onKeydown:l[1]||(l[1]=k=>V(k)),ref_key:"main",ref:C,onBlur:l[2]||(l[2]=k=>$())},null,544),c("div",W,[(B(),P(N,null,z(t,(k,R)=>c("div",X,[(B(!0),P(N,null,z(k,(w,T)=>(B(),O(j,{is_head:w.snake_head.value,is_body:w.snake_body.value,is_prop_one:w.prop_one.value,is_prop_two:w.prop_two.value,is_food_one:w.food_one.value,is_food_two:w.food_two.value,is_block:R==0||R==y-1||T==0||T==b-1},null,8,["is_head","is_body","is_prop_one","is_prop_two","is_food_one","is_food_two","is_block"]))),256))])),64))]),c("p",Y,"分数:"+M(d.value),1),c("p",Z,[c("p",null,"塑料数:"+M(E(n).length),1),S(c("p",{style:J({opacity:(E(n).length-150)/50,color:"red"})},"DANGER!",4),[[x,E(n).length>150]])]),S(c("p",{class:"decrease-time"},"减速有效时间:"+M(p.value),513),[[x,p.value!=0]]),S(c("p",{class:"plus-time"},"分数加倍有效时间:"+M(h.value),513),[[x,h.value!=0]])])}}},ae=q(ee,[["__scopeId","data-v-7aa4354a"]]);export{ae as default};
